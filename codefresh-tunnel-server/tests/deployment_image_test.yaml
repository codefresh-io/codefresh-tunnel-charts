suite: test deployment
templates:
  - tunnel-server-deployment.yaml
  - router-deployment.yaml
tests:
  - it: Server image
    template: tunnel-server-deployment.yaml
    values:
      - ./values/images.yaml
    asserts:
    - equal:
          path: spec.template.spec.containers[0].image
          value: myrepo/tunnel-server:1
  - it: plugin image
    template: tunnel-server-deployment.yaml
    values:
      - ./values/images.yaml
    asserts:
    - equal:
          path: spec.template.spec.containers[1].image
          value: myrepo/tunnel-plugin:2
  - it: plugin image
    template: router-deployment.yaml
    values:
      - ./values/images.yaml
    asserts:
    - equal:
          path: spec.template.spec.containers[0].image
          value: myrepo/tunnel-router:3